# Авто-постеры

Скрипт для автоматической генерации постеров автомобилей по данным с [automobile-catalog.com](https://www.automobile-catalog.com/):
выбор марки и модели, парсинг характеристик, поиск фотографии, генерация стильного постера и сохранение в PNG/JPG.

## Возможности

- **Парсинг каталога** — автоматический поиск моделей/модификаций на сайте, извлечение характеристик (при блокировке 403 используется headless-браузер Playwright)
- **Фото автомобиля** — поиск через Bing Images / DuckDuckGo, парсинг с сайта каталога, или генерация через OpenAI DALL-E (опционально)
- **Постер в стиле референса** — тёмный фон, крупная типографика, красные акценты, угловые метки, фото с градиентным затуханием, блок характеристик
- **Два режима макета** — с фотографией авто (если найдена) или только типографика (fallback)
- **Устойчивый пайплайн** — при недоступности сайта используются демо-данные (реальные характеристики популярных авто), постер генерируется всегда
- **CLI** — марка (обязательно), модель (опционально), выходной файл (опционально)

## Требования

- Python 3.10+
- Доступ в интернет (для парсинга и поиска фото)
- Playwright + Chromium (для обхода 403)

## Установка

```bash
# Клонирование
git clone https://github.com/Artem9908/OnlyArt.git
cd OnlyArt

# Виртуальное окружение
python -m venv .venv
.venv\Scripts\activate   # Windows
# source .venv/bin/activate  # Linux/macOS

# Зависимости
pip install -r requirements.txt

# Браузер для парсинга (обход 403)
playwright install chromium
```

**Референс постера:** положите приложенный к заданию пример постера «AUDI TT RS» в корень проекта как `reference.png` или `reference.jpg` — по нему будут подбираться размер и палитра.

**Опционально (AI-генерация фото):** задайте `OPENAI_API_KEY` в `.env` для генерации фото через DALL-E, если поиск через Bing не дал результатов.

## Использование

```bash
# Минимальный запуск (марка)
python main.py --brand Audi

# С указанием модели
python main.py --brand Audi --model "TT RS"

# Другие марки
python main.py -b BMW -m "M3"
python main.py -b Porsche -m "911 Turbo"
python main.py -b Nissan -m "GT-R Nismo"

# С указанием выходного файла
python main.py -b BMW -m M3 -o output/bmw_m3.png

# Подробный вывод
python main.py --brand Audi --model "TT RS" --verbose
```

Постер сохраняется в папку `output/` в формате PNG.

## Структура проекта

```
.
├── main.py                 # Точка входа, CLI, демо-данные
├── requirements.txt
├── .env.example
├── reference.png           # Референс постера из ТЗ (опционально)
├── src/
│   ├── config.py           # Настройки, путь к референсу, API-ключи
│   ├── catalog_parser.py   # Парсинг automobile-catalog.com
│   ├── browser_fetcher.py  # Загрузка страниц через Chromium
│   ├── image_finder.py     # Поиск фото авто (Bing / DuckDuckGo / DALL-E)
│   ├── reference_style.py  # Извлечение палитры из референса
│   └── poster_generator.py # Генерация постера (Pillow)
└── output/                 # Сгенерированные постеры
```

## Как работает поиск фото

1. **Парсинг каталога** — если на странице авто есть фото, оно извлекается
2. **Bing Images** — поиск по запросу «марка модель car photo HD»
3. **DuckDuckGo** — запасной поиск изображений
4. **OpenAI DALL-E** — AI-генерация (если задан `OPENAI_API_KEY`)
5. **Без фото** — если ничего не найдено, генерируется текстовый постер

## Конфигурация

| Переменная | Описание | По умолчанию |
|---|---|---|
| `AUTO_CATALOG_BASE` | Базовый URL каталога | `https://www.automobile-catalog.com` |
| `AUTO_REQUEST_TIMEOUT` | Таймаут запроса (сек) | `15` |
| `AUTO_REQUEST_RETRIES` | Число повторов | `3` |
| `AUTO_REQUEST_DELAY` | Задержка между запросами (сек) | `1.0` |
| `AUTO_OUTPUT_DIR` | Папка для постеров | `output` |
| `OPENAI_API_KEY` | API-ключ OpenAI (опционально) | — |

---

*При блокировке сайта (403) страницы загружаются через headless Chromium (Playwright). Фото автомобиля ищется через Bing/DuckDuckGo. Если ничего недоступно — используются встроенные демо-данные для качественного постера.*
